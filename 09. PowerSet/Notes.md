В данном случае решение отличается от эталонного тем, что реализация не вычисляет корректный размер результирующих множеств при операции intersect, union, difference.  Решил в финальной версии переделать, хотя изначальный вариант включал такой функционал. Вероятно, смутил формулировка о том, что необходимо учитывать максимальный размер множеств.  
